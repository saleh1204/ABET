<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content=""> 
        <script src="js/vendor/jquery-1.11.2.js"></script>
        <script src="js/vendor/jquery.js"></script>
        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />
        <link href="js/datatables/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
        <script src="js/vendor/jquery.dataTables.min.js"></script>         
        <script src="js/vendor/bootstrap.min.js"></script>
        <script src="js/main.js"></script>
        <title>Coordinator</title>
        <!-- Bootstrap core CSS -->



        <link rel="stylesheet" href="css/jquery.dataTables.min.css">
        <link rel="stylesheet" href="css/Select.css">

        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />


        <link href="css/bootstrap.css" rel="stylesheet">
        <!-- Custom styles for this template -->
        <link href="css/dashboard.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    </head>
    <body>



        <!-- Modal Update question -->
        <div class="modal fade" id="Update" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title">Update Question</h4>
                        </div>
                        <div class="col-md-4">
                            <form  role="form" id="updateF"> 
                                <div class="form-group"> 
                                    <label class="control-label" for="Qo">Order of the Question</label>                                                 
                                    <input type="number" min="0" class="form-control" id="Qo"  placeholder=""> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="Qt">Question Text</label>                                                 
                                    <input type="text" class="form-control" id="Qt" placeholder=""> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="SO">Student Outcome</label>                                                 
                                    <input type="text" class="form-control" id="SO" placeholder=""> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="Qs">Statues</label>                                                 
                                    <input type="text" class="form-control" id="Qs" placeholder=""> 
                                </div>   
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>

                                <button type="submit" id="updateex" class="btn btn-primary">Submit</button>                                             
                            </form>                                         
                        </div>
                        <div class="modal-footer">
                        </div>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>    

        <!-- Modal add question -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title">Add Question</h4>
                        </div>
                        <div class="col-md-4">
                            <form role="form" id="addQuestion"> 
                                <div class="form-group"> 
                                    <label class="control-label" for="Qorder">Order of the Question</label>                                                 
                                    <input type="number" min="0" class="form-control" id="Qorder" placeholder="Enter Order for the question"> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="Qtext">Question Text</label>                                                 
                                    <input type="text" class="form-control" id="Qtext" placeholder="Enter Question text"> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="studentOutcome">Student Outcome</label>                                                 
                                    <input type="text" class="form-control" id="studentOutcome" placeholder="Enter Student Outcome"> 
                                </div>
                                <div class="form-group"> 
                                    <label class="control-label" for="Qstatues">Statues</label>                                                 
                                    <input type="text" class="form-control" id="Qstatues" placeholder="Enter Question Statues "> 
                                    <input type="text" class="form-control" id="hiddenValueQ" style="display: none" > 
                                </div>   
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-primary">Submit</button>                                             
                            </form>                                         
                        </div>
                        <div class="modal-footer">
                        </div>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal-dialog -->
        </div>                     




        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Abet Report Generator</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#">Dashboard</a>
                        </li>
                        <li>
                            <a href="#">Settings</a>
                        </li>
                        <li>
                            <a href="#">Profile</a>
                        </li>
                        <li>
                            <a href="#">Help</a>
                        </li>
                    </ul>
                    <form class="navbar-form navbar-right">
                        <input type="text" class="form-control" placeholder="Search...">
                    </form>
                </div>
            </div>
        </nav>
        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-3 col-md-2 sidebar">
                    <ul class="nav nav-sidebar">
                        <li >
                            <a id="RCoptions" data-toggle="collapse" data-target="#ReportCenter" ><span class="glyphicon glyphicon-collapse-down"></span> Report Center</a>
                        </li>
                        <li  >

                            <div class="container">

                                <div id="ReportCenter" class="collapse">
                                    <ul class="nav nav-sidebar"> <li >
                                            <a href="index.html">      - Exit Survey</a>
                                        </li>
                                        <li  >
                                            <a href="employerSurvey.html">      - Employer Survey</a>
                                        </li>
                                        <li>
                                            <a href="CLOSurvey.html">      - CLO Survey</a>
                                        </li>
                                        <li>
                                            <a href=" rubricsSurvey.html">      - Rubrics Survey </a>
                                        </li>    </ul> </div>
                            </div> 
                        </li>
                        <li class="active">
                            <a href="PO.html">Program Outcomes</a>
                        </li>
                        <li>
                            <a href="changePO.html">Change Program Outcomes</a>
                        </li>
                        <li>
                            <a href="employeSurvey.html">Employe Survey</a>
                        </li>
                        <li>
                            <a href="exitSurvey.html">Exit Survey</a>
                        </li>

                    </ul>
                </div>
                <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
                    <h1 class="page-header">Report Center</h1>
                    <div class="row placeholders">
                    </div>
                    <h2 class="sub-header">CLO Survey</h2>

                    <nav class="navbar navbar-inverse navbar-fixed-top">
                        <div class="container">
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                                    <span class="sr-only">Toggle navigation</span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                    <span class="icon-bar"></span>
                                </button>
                                <a class="navbar-brand" href="index.html">Abet Report Generator</a>
                            </div>
                            <div id="navbar" class="navbar-collapse collapse" aria-expanded="false" style="height: 1px;">
                                <ul class="nav navbar-nav">

                                </ul>
                            </div>
                            <!--/.nav-collapse -->
                        </div>
                    </nav>

                    <!--<script>
$(function() {
//twitter bootstrap script
    $("button#submit").click(function(){
                    $.ajax({
                    type: "POST",
                    url: "process.php",
                    data: $('form.contact').serialize(),
                    success: function(msg){
                              $("#thanks").html(msg)
                            $("#form-content").modal('hide');	
                    },
                    error: function(){
                            alert("failure");
                            }
                    });
    });
});
</script> -->

                    <link rel="stylesheet" type="text/css" href="http://www.shieldui.com/shared/components/latest/css/light/all.min.css" />
                    <script type="text/javascript" src="http://www.shieldui.com/shared/components/latest/js/shieldui-all.min.js"></script>

                    <script type="text/javascript">


                        $(document).ready(function () {

   // get terms 
                            var parameters = {
                                grp: "DBA",
                                cmd: "getSemesters"

                            };
                            $.getJSON("../index.php", parameters).done(function (data, textStatus, jqXHR) {
                                var terms = [];
                                for (var i = 0; i < data.length; i++)
                                {
                                    terms[i] = data[i].semesterNum;
                                    alert(terms[i]);
                                }

                                creatSelectOptions("#endT", terms);
                            }
                            ).fail(function (jqXHR, textStatus, errorThrown)
                            {// log error to browser's console
                                console.log(textStatus + "\n" + errorThrown.toString());
                            });

                            function creatSelectOptions(id, data)
                            {  //not sure if it will work or it neads .each
                                //$(id).html("");//clear the defualt value
                                var select = $(id);
                                select.empty();
                                for (var i = 0; i < data.length; i++) {
                                    select.append("<option value='" + data[i] + "'>" + data[i] + "</option>");
                                }
                            }

                            table = [];


                            function creatTable(id, data)
                            {
                                var eh= "tableH";
                                var e = "tableHeading";//alert(0);
                                var i;
                                var c = [];
                                $.each(data, function (i, q) {
                                    c[i] = q.PO;
                                });

                                for (i = 0; i < id; i++) {
                                    $("#table" + i + "").html("<div class='panel panel-default'><div class='panel-heading'>Student Outcome (" + c[i] + ") Summary</div> <div class='panel-body'>  <button type='button' id='button" + i + "'  onclick='setValue(" + i + ");' class='btn btn-primary btn-sm' data-toggle='modal' data-target='#myModal'>Add Question</button><hr/><div class='dataTable_wrapper'><table class='table table-striped table-bordered table-hover' id='dataTables-example" + i + "'><thead><tr id='row" + i + "'></tr></thead></table></div></div></div><hr id='table" + (i + 1) + "' />");
                                    $.each(data, function (x, q) {
                                        $("#row" + i + "").append("<th>" + "here" + q.h + "</th>");
                                    });
                                    $("#row" + i + "").append("<th></th>");    //  a new columon for buttons               

//    var t= "row"+i+"";

                                    table[i] = $("#dataTables-example" + i + "").DataTable({
                                        'ajax': "datatable.txt",
                                        responsive: true,
                                        columnDefs: [{
                                                "targets": -1,
                                                "data": null,
                                                "defaultContent": "<button class='btn btn-success btn-sm' onclick='update_form(" + i + ");'  id='updateb' data-toggle='modal' data-target='#Update'>Update!</button><button class='btn btn-danger btn-sm' onclick='delete_row(" + i + ");' id='delete'>Delete</button>"
                                            }]
                                                /*    "scrollY":        '50vh',
                                                 "scrollCollapse": true,
                                                 "paging":         false,
                                                 "stateSave": true*/
//     "columns": [
//          { "data": "name" },
//            { "data": "position" },
//          { "data": "office" },
//          { "data": "extn" },
//          { "data": "start_date" },
//         { "data": "salary" }
//      ]



                                    }); //end of ajax
                                    //           alert(3);


                                }
                                ;//end of for loop 


                                $("#table" + i + "").append("<hr id='report'/>");
                            }








                              function creatReport(SOCode, HPerformace)
                            {
                                $("#report").html("<div class='row'><div class='col-lg-12 col-md-12 '><div class='panel panel-info'><div class='panel-heading'><h3>Quarterly Sales</h3></div><div class='panel-body'><div id='performance2' style='height: 270px;'></div></div></div></div></div>");

                                $("#performance2").shieldChart({
                                    primaryHeader: {
                                        text: "Visitors"
                                    },
                                    axisX: {
                                        collectionAlias: "StudentOutcome",
                                        categoricalValues: SOCode},
                                    dataSeries: [{
                                            seriesType: "bar",
                                            collectionAlias: "HPerformace",
                                            data: HPerformace
                                        }]
                                });
                            }


                            //modal add Question submit
                            $('#myModal').submit(function (event) {
                                event.preventDefault();
                                alert("kkkkohoho");
                                var formData = {
                                    grp: "Faculty",
                                    cmd: "addQuestion",
                                    order: $('input[id=Qorder]').val(),
                                    questionText: $('input[id=Qtext]').val(),
                                    SOCode: $('input[id=studentOutcome]').val(),
                                    statusName: $('input[id=Qstatues]').val()
                                };
                                var tableNumber = $("#hiddenValueQ").val();





//reset data modele values
                                $('input[id=Qorder]').val("");
                                $('input[id=Qtext]').val("");
                                $('input[id=studentOutcome]').val("");
                                $('input[id=Qstatues]').val("");
                                $("#hiddenValueQ").val("");
                                $('#myModal').modal('hide');

                            });
//modal update submit       

                            $('#Update').submit(function (event) {

                                // get the form data
                                // there are many ways to get this data using jQuery (you can use the class or id also)
                                var formData = {
                                    grp: "Faculty",
                                    cmd: "updateQuestion",
                                    order: $('input[id=Qo]').val(),
                                    questionText: $('input[id=Qt]').val(),
                                    SOCode: $('input[id=SO]').val(),
                                    statusName: $('input[id=Qs]').val()
                                };
                                var outcome = $("#hiddenValueQ").val();





//reset data modele values
                                $('input[id=Qo]').val("");
                                $('input[id=Qt]').val("");
                                $('input[id=SO]').val("");
                                $('input[id=Qs]').val("");
                                $("#hiddenValueQ").val("");
                                $('#myModal').modal('hide');

                                alert("Look what happened " + $('#Qt').val());
                                event.preventDefault();
                                alert("hohohohoho");

                            });
//start generating tables
                             $('.form-inline').submit(function (event) {
                                event.preventDefault();

                                var PO = [];
                                var table = [];


                                var parameters = {//for the courses
                                    grp: "Coordinator",
                                    cmd: "getPO",
                                    Term: $("#chooseT option:selected").val() //expected an array of PO
                                };
                                $.getJSON("../index.php", parameters).done(function (data, textStatus, jqXHR) {

                                    for (var i = 0; i < data.length; i++)//1d array Courses
                                    {
                                        courses[i] = data[i].courseCode;
                                    }

                                }
                                ).fail(function (jqXHR, textStatus, errorThrown)
                                {// log error to browser's console
                                    console.log(textStatus + "\n" + errorThrown.toString());
                                });//*****end creat Courses


                                var i;
                                for (i = 0; i < courses.length; i++) {//to initiat and create dataTable and Titles for each Course
                                    var datatable = [];
                                    var titles = [];
                                    $("#table" + i + "").html("<div class='panel panel-default'><div class='panel-heading'>" + courses[i] + "Survey Summery <bold/></div> <div class='panel-body'><div class='dataTable_wrapper'><table class='table table-striped table-bordered table-hover' id='dataTables-example" + i + "'>/table></div></div></div><hr id='table" + (i + 1) + "' />");

                                    var parameters = {//for the tables
                                        grp: "Coordinator",
                                        cmd: "getCLOSurvey",
                                        PNameShort:'CS',
                                        courseCode: 233//courses[i] //expected an array of #,Question,4,3,2,1,0, average
                                    };
                                    $.getJSON("../index.php", parameters).done(function (data, textStatus, jqXHR) {

                                        for (var j = 0; j < data.length; j++)//2d array
                                        {
                                            datatable[j] = [];
                                        }
                                        for (var x = 0; x < data.length; x++)//fill 2d array
                                        {
                                            datatable[x][0] = data[x].Sr;
                                            datatable[x][1] = data[x].Question;
                                            datatable[x][2] = data[x].Exellent;
                                            datatable[x][3] = data[x].Vgood;
                                            datatable[x][4] = data[x].Good;
                                            datatable[x][5] = data[x].Fair;
                                            datatable[x][6] = data[x].Poor;
                                            datatable[x][7] = data[x].ave;

                                        }

                                        titles[0] = {title: "Sr"};
                                        titles[1] = {title: "Question"};
                                        titles[2] = {title: "4"};
                                        titles[3] = {title: "3"};
                                        titles[4] = {title: "2"};
                                        titles[5] = {title: "1"};
                                        titles[6] = {title: "0"};
                                        titles[7] = {title: "ave"};

                                        table[i] = $("#dataTables-example" + i + "").DataTable({
                                            data: datatable,
                                            columns: titles

                                        }); //end of ajax

                                    }
                                    ).fail(function (jqXHR, textStatus, errorThrown)
                                    {// log error to browser's console
                                        console.log(textStatus + "\n" + errorThrown.toString());
                                    });//*****end created one Table
                                }//*****end of for loop to creat all Tables
                                $("#table" + i + "").append("<hr id='report'/>");


                                var parameters = {//for the chart figure
                                    grp: "Coordinator",
                                    cmd: "getChartData"//not sure of the command

                                            //expected an array of SOCode,highestmarks
                                };
                                $.getJSON("../index.php", parameters).done(function (data, textStatus, jqXHR) {
                                    var SOCode = [];
                                    var highestmarks = [];//not sure of this

                                    for (var i = 0; i < data.length; i++)//fill 2d array
                                    {
                                        SOCode[i] = data[i].SOCode;
                                        highestmarks[i] = data[i].highestmarks;

                                    }
                                    creatReport(SOCode, highestmarks);


                                }
                                ).fail(function (jqXHR, textStatus, errorThrown)
                                {// log error to browser's console
                                    console.log(textStatus + "\n" + errorThrown.toString());
                                });//*****end Chart Figure




                            });







                            /* //initialize update form
                             $('#example tbody').on( 'click', '#updateb', function () {
                             var data = table[i].row( $(this).parents('tr') ).data();
                             $("#Qo").val(data[0]);
                             $("#Qt").val(data[1]);
                             $("#SO").val(data[2]);
                             $("#Qs").val(data[3]);
                             
                             } ); */
//delete row from table
//   $('#example tbody').on( 'click', '#delete', function () {
//       var data = table.row( $(this).parents('tr') ).data();
//       table.row($(this).parents('tr')).remove().draw( false );          
                            /* $.ajax(
                             "index.php",
                             {
                             type: "DELETE",
                             processData: true,
                             data: {
                             grp: "Faculty",
                             cmd: "Delete",
                             order: data[0] , questionText: data[1] ,studentOutcome: data[2] ,statues: data[3]
                             
                             
                             },
                             dataType: "json",
                             success: function (json) {
                             
                             updateTable(json);
                             },
                             error: function (jqXHR, textStatus, errorThrown) {
                             alert("Error: " + jqXHR.responseText);
                             alert("Error: " + textStatus);
                             alert("Error: " + errorThrown);
                             }
                             });*/

// } );








/*

                            function creatSelectOptions(id, data)
                            {
                                $.each(data, function (i, q) {
                                    $(id).append("<option value='" + q.term + "'>" + q.term + "</option>");
                                });
                            }

*/
// $("#startT").change(function(){
//          var data =[{term:112},{term:113},{term:122},{term:123},{term:134}];               
//          creatSelectOptions("#startT",data );
//       } );

                            $("#endT").change(function () {
                               // var data = [{term: 134444444442}, {term: 113}, {term: 122}, {term: 123}, {term: 134}];
                               // creatSelectOptions("#endT", data);
                            });


//for the small picture in the navbar       
                            $("#ReportCenter").on("hide.bs.collapse", function () {
                                $("#RCoptions").html('<span class="glyphicon glyphicon-collapse-down"></span> Report Center');
                            });
                            $("#ReportCenter").on("show.bs.collapse", function () {
                                $("#RCoptions").html('<span class="glyphicon glyphicon-collapse-up"></span> Report Center');
                            });

                            /*function creatCol () {
                             for(i=2;i<table.row(0).data().length; i++){
                             $("#example thead tr").html('<th> '+i +'</th>');
                             };
                             }; */




                            $("#selectexample").change(function () {
                                alert($('#selectexample option:selected').val());
                                /*$.ajax({ 
                                 url: 'arrays.txt',
                                 type: 'POST',
                                 data:  {term :$('#selectexample option:selected').val()},
                                 success:function(data){
                                 alert ('success');
                                 },
                                 error:function(){
                                 alert ('error');
                                 }
                                 });*/
                            });



                        });


                        /*jQuery(function ($) {
                         Outcomes = ["a","b","c","d" ],
                         performance = [23, 19, 11, 34];
                         $("#performance2").shieldChart({
                         primaryHeader: {
                         text: "Visitors"
                         },
                         axisX: {
                         categoricalValues: Outcomes },
                         dataSeries: [{
                         seriesType: "bar",
                         collectionAlias: "performance",
                         data: performance
                         }]
                         });
                         
                         });*/

                        function setValue(u)
                        {
                            var x = 0;// just so it does not keep looping 


                            $("body   ").on('click', '#button' + u + '', function () {
                                if (x !== 0) {
                                    return;
                                }
                                ;
                                event.preventDefault();
                                $("#hiddenValueQ").val(u);
                                // console.log(u);
                                // alert( $("#hiddenValueQ").val() );


                                x++;
                            });
                        }

                        function update_form(u)
                        {
                            var x = 0;// just so it does not keep looping 

                            //initialize update form
                            $("#dataTables-example" + u + " ").on('click', '#updateb', function (event) {
                                if (x !== 0) {
                                    return;
                                }
                                ;
                                event.preventDefault();
                                console.log(u);
                                var data = table[u].row($(this).closest('tr')).data();
                                $("#Qo").val(data[0]);
                                $("#Qt").val(data[1]);
                                $("#SO").val(data[2]);
                                $("#Qs").val(data[3]);

                                x++;
                            });
                        }

                        function delete_row(u)
                        {
                            var x = 0;// just so it does not keep looping 
// alert("hh");
                            //delete row from table
                            $("#dataTables-example" + u + " tbody tr ").on('click', '#delete', function () {
                                if (x !== 0) {
                                    return;
                                }
                                ;
                                var data = table[u].row($(this).closest('tr')).data();
                                table[u].row($(this).closest('tr')).remove().draw(false);

                                var formData = {
                                    grp: "Faculty",
                                    cmd: "Delete",
                                    order: data[0], questionText: data[1], studentOutcome: data[2], statues: data[3]


                                };

                                // alert("hh hh");
                                /* $.ajax(
                                 "index.php",
                                 {
                                 type: "DELETE",
                                 processData: true,
                                 data: {
                                 grp: "Faculty",
                                 cmd: "Delete",
                                 order: data[0] , questionText: data[1] ,studentOutcome: data[2] ,statues: data[3]
                                 
                                 
                                 },
                                 dataType: "json",
                                 success: function (json) {
                                 
                                 updateTable(json);
                                 },
                                 error: function (jqXHR, textStatus, errorThrown) {
                                 alert("Error: " + jqXHR.responseText);
                                 alert("Error: " + textStatus);
                                 alert("Error: " + errorThrown);
                                 }
                                 });*/



                                x++;
                            });
                        }


                    </script> 

                    <div class="col-lg-10">
                        <form class="form-inline">

                            <div class="form-group">
                                <label >       Choose Term   :   </label>
                                <select id="endT" class=" form-control">
                                    <option>132</option>
                                    
                                </select>   </div>
                            <button type="submit" id="generate" class="btn btn-success">Generate Reports</button>
                        </form> 

                    </div >

                    <hr id="table0" />



                </div>
            </div>
        </div>

        <!-- Bootstrap core JavaScript
    ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->

        <!-- Metis Menu Plugin JavaScript -->

        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    </body>
</html>
